<%- include('partials/head', { title: 'ArtaPack | ورود' }) %>

    <main class="flex-1 flex items-center justify-center px-4 sm:px-6 py-6 sm:py-10">
        <div class="w-full max-w-md mx-auto" style="animation: fadeUp .5s ease both;">

            <!-- لوگو -->
            <div class="text-center mb-6 sm:mb-8">
                <div class="w-[88px] h-[88px] mx-auto mb-4 rounded-full overflow-hidden
                        ring-[3px] ring-brand-200 shadow-lg shadow-brand-500/15">
                    <img src="/images/generated-image.png" alt="لوگوی آرتاپک" class="w-full h-full object-cover">
                </div>
                <h2 class="text-[20px] font-extrabold text-gray-800">ورود به حساب</h2>
                <p class="text-[12px] text-gray-400 mt-1.5">اطلاعات خود را وارد کنید</p>
            </div>

            <!-- پیام خطا -->
            <% if (typeof error !=='undefined' && error) { %>
                <div class="mb-5 bg-red-50 border border-red-200 rounded-xl px-4 py-3 flex items-center gap-2.5">
                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-red-100 flex items-center justify-center">
                        <svg class="w-4 h-4 text-red-500" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10" />
                            <line x1="15" y1="9" x2="9" y2="15" />
                            <line x1="9" y1="9" x2="15" y2="15" />
                        </svg>
                    </div>
                    <p class="text-[12px] text-red-600 font-semibold">
                        <%= error %>
                    </p>
                </div>
                <% } %>

                    <!-- پیام موفقیت -->
                    <% if (typeof success !=='undefined' && success) { %>
                        <div
                            class="mb-5 bg-green-50 border border-green-200 rounded-xl px-4 py-3 flex items-center gap-2.5">
                            <div
                                class="flex-shrink-0 w-8 h-8 rounded-full bg-green-100 flex items-center justify-center">
                                <svg class="w-4 h-4 text-green-600" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polyline points="20 6 9 17 4 12" />
                                </svg>
                            </div>
                            <p class="text-[12px] text-green-700 font-semibold">
                                <%= success %>
                            </p>
                        </div>
                        <% } %>

                            <!-- فرم لاگین -->
                            <form action="/login" method="POST" class="space-y-5" id="loginForm">

                                <!-- نام کاربری -->
                                <div>
                                    <label for="username"
                                        class="block text-[12px] font-bold text-gray-600 mb-2 mr-1">نام کاربری</label>
                                    <div class="relative">
                                        <span
                                            class="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-300 pointer-events-none">
                                            <svg class="w-[18px] h-[18px]" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                                                stroke-linejoin="round">
                                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                                <circle cx="12" cy="7" r="4" />
                                            </svg>
                                        </span>
                                        <input type="text" id="username" name="username" required
                                            autocomplete="username" placeholder="نام کاربری را وارد کنید"
                                            value="<%= typeof username !== 'undefined' ? username : '' %>" class="w-full pr-11 pl-4 py-3.5 bg-cream-50 border-2 border-gray-100
                                  rounded-xl text-[13px] text-gray-700 placeholder-gray-300
                                  outline-none font-medium transition-all duration-300
                                  focus:border-brand-500 focus:shadow-[0_0_0_3px_rgba(249,115,22,.15)]">
                                    </div>
                                </div>

                                <!-- رمز عبور -->
                                <div>
                                    <label for="password"
                                        class="block text-[12px] font-bold text-gray-600 mb-2 mr-1">رمز عبور</label>
                                    <div class="relative">
                                        <span
                                            class="absolute right-3.5 top-1/2 -translate-y-1/2 text-gray-300 pointer-events-none">
                                            <svg class="w-[18px] h-[18px]" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                                                stroke-linejoin="round">
                                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                            </svg>
                                        </span>
                                        <input type="password" id="password" name="password" required
                                            autocomplete="current-password" placeholder="رمز عبور را وارد کنید" class="w-full pr-11 pl-11 py-3.5 bg-cream-50 border-2 border-gray-100
                                  rounded-xl text-[13px] text-gray-700 placeholder-gray-300
                                  outline-none font-medium transition-all duration-300
                                  focus:border-brand-500 focus:shadow-[0_0_0_3px_rgba(249,115,22,.15)]">
                                        <button type="button" id="togglePassword"
                                            class="absolute left-3.5 top-1/2 -translate-y-1/2 text-gray-300 hover:text-brand-500 transition-colors">
                                            <svg id="eyeOff" class="w-[18px] h-[18px]" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                                                stroke-linejoin="round">
                                                <path
                                                    d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94" />
                                                <path
                                                    d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19" />
                                                <path d="M14.12 14.12a3 3 0 1 1-4.24-4.24" />
                                                <line x1="1" y1="1" x2="23" y2="23" />
                                            </svg>
                                            <svg id="eyeOn" class="w-[18px] h-[18px] hidden" viewBox="0 0 24 24"
                                                fill="none" stroke="currentColor" stroke-width="1.8"
                                                stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                                <circle cx="12" cy="12" r="3" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>

                                <!-- م فراموشی -->
                                <div class="flex items-center justify-between">
                                    <a href="/forgot-password"
                                        class="text-[11px] text-brand-500 hover:text-brand-700 font-semibold transition-colors">
                                        فراموشی رمز عبور
                                    </a>
                                </div>

                                <!-- دکمه ورود -->
                                <button type="submit" id="submitBtn" class="w-full py-3.5 rounded-xl text-white font-extrabold text-[15px]
                           flex items-center justify-center gap-2 mt-2 transition-all duration-300
                           bg-gradient-to-l from-brand-400 via-brand-500 to-brand-600
                           hover:from-brand-500 hover:via-brand-600 hover:to-brand-700
                           hover:-translate-y-0.5 hover:shadow-lg hover:shadow-brand-500/35
                           active:translate-y-0">
                                    <span id="btnText">ورود به پنل</span>
                                    <svg id="btnArrow" class="w-5 h-5 rotate-180" viewBox="0 0 24 24" fill="none"
                                        stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <line x1="5" y1="12" x2="19" y2="12" />
                                        <polyline points="12 5 19 12 12 19" />
                                    </svg>
                                    <svg id="btnSpinner" class="w-5 h-5 animate-spin hidden" viewBox="0 0 24 24"
                                        fill="none">
                                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3"
                                            opacity=".25" />
                                        <path d="M12 2a10 10 0 0 1 10 10" stroke="currentColor" stroke-width="3"
                                            stroke-linecap="round" />
                                    </svg>
                                </button>

                            </form>

                            <!-- بازگشت -->
                            <div class="text-center mt-8">
                                <a href="/"
                                    class="inline-flex items-center gap-1.5 text-[12px] text-gray-400 hover:text-brand-500 font-medium transition-colors group">
                                    <svg class="w-4 h-4 transition-transform group-hover:translate-x-0.5"
                                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="19" y1="12" x2="5" y2="12" />
                                        <polyline points="12 19 5 12 12 5" />
                                    </svg>
                                    بازگشت به منو
                                </a>
                            </div>

        </div>
    </main>

    <script>
        // نمایش/مخفی رمز
        document.getElementById('togglePassword').addEventListener('click', function () {
            const input = document.getElementById('password');
            const off = document.getElementById('eyeOff');
            const on = document.getElementById('eyeOn');
            if (input.type === 'password') {
                input.type = 'text';
                off.classList.add('hidden');
                on.classList.remove('hidden');
            } else {
                input.type = 'password';
                off.classList.remove('hidden');
                on.classList.add('hidden');
            }
        });

        // لودینگ دکمه
        document.getElementById('loginForm').addEventListener('submit', function () {
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.classList.add('opacity-75');
            document.getElementById('btnText').textContent = 'لطفاً صبر کنید...';
            document.getElementById('btnArrow').classList.add('hidden');
            document.getElementById('btnSpinner').classList.remove('hidden');
        });

        // فوکوس خودکار
        const u = document.getElementById('username');
        if (u && !u.value) u.focus();
    </script>
